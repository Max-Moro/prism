# Лесенка уровней и глоссарий PRISM

> **Назначение** — дать единое понятийное поле всем участникам проекта: от SRE‑инженеров до руководителей проектов.
>
> **Читается** перед знакомством с Blueprint и архитектурой.

---

## 1. «Лесенка» уровней описания

| № | Слой (RU / EN)                                                  | Что входит                                                                                                                              | Пример метрик в PRISM                    | Почему важно бизнесу                                                          |
| - | --------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- | ----------------------------------------------------------------------------- |
| 0 | **Аппаратный слой** / **Hardware Layer**                        | Физические серверы, СХД, сеть, питание                                                                                                  | CPU cores, RAM GB, IOPS, Rack Units      | Стоимость CAPEX, место в ДЦ, энергопотребление                                |
| 1 | **Слой виртуализации (IaaS / VM Layer)**                        | vCPU, vRAM, виртуальные диски, зоны доступности                                                                                         | vCPU, vRAM, vDisk GB/IOPS                | Гибкая аренда ресурсов, миграция в облако                                     |
| 2 | **Слой контейнерной платформы (Container Orchestration Layer)** | Kubernetes / OpenShift узлы, namespaces, HPA‑политики                                                                                   | `requests/limits`, HPA rules, node‑pools | Быстрый выпуск версий без закупки нового железа                               |
| 3 | **Слой сервисных компонентов (Service Component Layer)**        | **3A — Application Services** (бизнес‑сервисы)<br>**3B — Infrastructure Services** (PostgreSQL, Kafka, S3, ClickHouse, generic‑сервисы) | RPS, p95‑latency, bucket GB, partitions  | Чётко видно, что «пишут разработчики» и что «покупает/разворачивает» заказчик |

### Как PRISM использует уровни

- **Blueprint** концентрируется на уровнях 2 и 3: описывает контейнерные ресурсы (`resource_profiles`) и зависимость Application ↔ Infrastructure.
- **Core‑Model** транслирует расчёт вниз до уровней 1‑0, чтобы сформировать итоговый сайзинг (CPUs, RAM, диски) для IaaS‑ или on‑prem‑команд заказчика.

---

## 2. Глоссарий ключевых терминов

### 2.1 Бизнес‑ и сервис‑уровень

| Термин                       | Простое объяснение                                                                             | Где встречается в PRISM                        |
| ---------------------------- | ---------------------------------------------------------------------------------------------- | ---------------------------------------------- |
| **BusinessModule**           | Логический функциональный блок, который видит пользователь («Инспекции», «Картография»).       | `business_modules` в Blueprint, UI‑калькулятор |
| **TechnicalService**         | Фактический контейнер/процесс, реализующий логику. Может обслуживать несколько BusinessModule. | `technical_services`                           |
| **GenericService**           | Общесистемный сервис (ЭЦП, уведомления, СЗИ), от которого зависит множество TechnicalService.  | `generic_services`                             |
| **InfrastructureDependency** | Внешняя инфраструктура (PostgreSQL, Kafka, S3/FS, ClickHouse).                                 | `infra_dependencies`                           |

### 2.2 Нагрузочные параметры

| Параметр                   | Что это                                | Типовое влияние                         |
|----------------------------|----------------------------------------|-----------------------------------------|
| **online\_users**          | Одновременные пользователи в пике      | CPU/Memory профили `@dyn`, RPS          |
| **total\_users**           | Всего зарегистрированных               | Ёмкость БД (structured\_data\_gb)       |
| **rps / rps\_p95**         | Запросов в секунду / в 95‑м процентиле | Кол‑во партиций Kafka, HPA‑триггер      |
| **structured\_data\_gb**   | Реляционные данные (PostgreSQL)        | Размер хранилища, резервное копирование |
| **unstructured\_data\_gb** | Файловое и объектное хранилище         | S3 bucket GB, throughput S3/FS    |
| **jobs_rate**              | Кол-во задач/сек в фоновых воркерах    | Размер пула воркеров, CPU воркера       |

### 2.3 Ресурсные профили

| Термин              | Значение                                                                                          |
| ------------------- | ------------------------------------------------------------------------------------------------- |
| **ResourceProfile** | Шаблон `requests/limits` для Pod’а. Может быть `static` или `dynamic` (формула от online\_users). |
| `@dyn`              | Суффикс в Blueprint, означающий использование динамического профиля (`medium-web@dyn`).           |

---

## 3. Взаимосвязь терминов в PRISM

```
BusinessModule
    ↓ activates
TechnicalService(s)
    ↓ depend_on
GenericService(s) & InfrastructureDependency
    ↓ request resources via
ResourceProfile (static / dynamic)
    ↓ aggregated by Core‑Model
IaaS / Hardware sizing sheets
```

---

## 4. Рекомендации по употреблению терминов

1. В коммерческих предложениях используйте слои 3 и 2 — это понятно бизнесу.
2. В технических спринт‑доках ссылайтесь на **BusinessModule → TechnicalService → ResourceProfile**.
3. Не путайте **online\_users** (пиковая одновременная нагрузка) и **total\_users** (штат базы). От них счёт разный.
4. Если в тексте встречается «модуль СЗИ», уточняйте, что это **GenericService** — помогает избежать путаницы с бизнес‑модулями.

---

## 5. Связанные документы

- [Blueprint DSL](blueprint_dsl.md) — подробный формат YAML‑описания.
- [Архитектурный обзор](architecture_overview.md) — как слои вписываются в сервисную архитектуру.
- [Roadmap](roadmap.md) — когда появятся новые ResourceProfile или параметры нагрузки.

